import{u as P,j as e}from"./app-Bo2Vbsnc.js";import{c as S,B as n,a as l}from"./createLucideIcon-XQw2-DSi.js";import{I as d}from"./input-okKGAgmh.js";import{L as t}from"./label-Dk2z4hvO.js";import{S as C,a as F,b as w,c as D,d as I}from"./select-VnT2g1FZ.js";import{P as m,a as p,b as u,C as h}from"./popover-YZJZ8lM_.js";import{t as x}from"./index-C2ywKrme.js";import{C as f}from"./calendar-D3tbVsXp.js";import{f as j,a as o}from"./fr-BP0VUzFK.js";/* empty css            */import"./index-BNGQMMhk.js";import"./index-vs_CEgml.js";import"./chevron-right-DL2bW7BS.js";import"./check-PfBPDYQe.js";import"./chevron-left-CeZ96CWT.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k=[["path",{d:"M13.234 20.252 21 12.3",key:"1cbrk9"}],["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 0 2.828 2 2 0 0 0 2.828 0l8.414-8.586a4 4 0 0 0 0-5.656 4 4 0 0 0-5.656 0l-8.415 8.585a6 6 0 1 0 8.486 8.486",key:"1pkts6"}]],z=S("Paperclip",k);function Q({attachableType:_,attachableId:g,typesPieces:N}){const{data:s,setData:r,post:v,processing:c,reset:y}=P({type_piece:"",numero_piece:"",fichier:null,date_emission:new Date,date_expiration:null}),b=i=>{i.preventDefault();const a=new FormData;a.append("type_piece",s.type_piece),a.append("numero_piece",s.numero_piece),s.fichier&&a.append("fichier",s.fichier),a.append("date_emission",s.date_emission.toISOString()),s.date_expiration&&a.append("date_expiration",s.date_expiration.toISOString()),v(`/piece-jointes/attach/${_}/${g}`,{data:a,preserveScroll:!0,onSuccess:()=>{y(),x.success("Pièce jointe ajoutée avec succès")},onError:()=>{x.error("Erreur lors de l'ajout de la pièce jointe")}})};return e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsx("h3",{className:"font-medium mb-4",children:"Ajouter une pièce jointe"}),e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"type_piece",children:"Type de pièce *"}),e.jsxs(C,{value:s.type_piece,onValueChange:i=>r("type_piece",i),children:[e.jsx(F,{children:e.jsx(w,{placeholder:"Sélectionner un type"})}),e.jsx(D,{children:N.map(i=>e.jsx(I,{value:i,children:i},i))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"numero_piece",children:"Numéro de pièce *"}),e.jsx(d,{id:"numero_piece",value:s.numero_piece,onChange:i=>r("numero_piece",i.target.value),placeholder:"1234567890"})]}),e.jsxs("div",{className:"space-y-2 md:col-span-2",children:[e.jsx(t,{htmlFor:"fichier",children:"Fichier *"}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs(t,{htmlFor:"fichier",className:"flex flex-col items-center justify-center w-full h-32 border-2 border-dashed rounded-lg cursor-pointer hover:bg-accent",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[e.jsx(z,{className:"w-8 h-8 mb-4 text-muted-foreground"}),e.jsxs("p",{className:"mb-2 text-sm text-muted-foreground",children:[e.jsx("span",{className:"font-semibold",children:"Cliquez pour uploader"})," ou glissez-déposez"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.fichier?s.fichier.name:"PDF, JPG, PNG (max. 2MB)"})]}),e.jsx(d,{id:"fichier",type:"file",className:"hidden",onChange:i=>{i.target.files&&r("fichier",i.target.files[0])}})]})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"date_emission",children:"Date d'émission *"}),e.jsxs(m,{children:[e.jsx(p,{asChild:!0,children:e.jsxs(n,{variant:"outline",className:l("w-full justify-start text-left font-normal",!s.date_emission&&"text-muted-foreground"),children:[e.jsx(f,{className:"mr-2 h-4 w-4"}),s.date_emission?j(s.date_emission,"PPP",{locale:o}):e.jsx("span",{children:"Choisir une date"})]})}),e.jsx(u,{className:"w-auto p-0",children:e.jsx(h,{mode:"single",selected:s.date_emission,onSelect:i=>i&&r("date_emission",i),initialFocus:!0,locale:o})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(t,{htmlFor:"date_expiration",children:"Date d'expiration"}),e.jsxs(m,{children:[e.jsx(p,{asChild:!0,children:e.jsxs(n,{variant:"outline",className:l("w-full justify-start text-left font-normal",!s.date_expiration&&"text-muted-foreground"),children:[e.jsx(f,{className:"mr-2 h-4 w-4"}),s.date_expiration?j(s.date_expiration,"PPP",{locale:o}):e.jsx("span",{children:"Choisir une date"})]})}),e.jsx(u,{className:"w-auto p-0",children:e.jsx(h,{mode:"single",selected:s.date_expiration||void 0,onSelect:i=>r("date_expiration",i||null),initialFocus:!0,locale:o})})]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(n,{type:"submit",disabled:c,size:"sm",children:c?"Enregistrement...":"Attacher la pièce"})})]})]})}export{Q as default};
