import{j as e,H as v,L as i,a as c}from"./app-Bo2Vbsnc.js";import{A}from"./app-layout-DdHLMRH3.js";import{B as n}from"./createLucideIcon-XQw2-DSi.js";import{I as N}from"./input-okKGAgmh.js";import{P as _,S as T,T as D,a as S,b as h,c as r,d as C,e as t,E as w,A as $,f as M,g as P,h as F,i as H,j as k,k as E,l as I,m as L,n as V,o as z}from"./alert-dialog-TgMpf1VQ.js";import{t as m}from"./index-C2ywKrme.js";import{S as B,a as R,b as G,c as O,d as j}from"./select-VnT2g1FZ.js";import{F as U}from"./file-fFMIPO2x.js";import{P as q}from"./pencil-BHJjtLn-.js";import{f as p,a as x}from"./fr-BP0VUzFK.js";/* empty css            */import"./index-vs_CEgml.js";import"./chevron-right-DL2bW7BS.js";import"./index-BNGQMMhk.js";import"./app-logo-icon-CS4oG-CN.js";import"./chevron-left-CeZ96CWT.js";import"./check-PfBPDYQe.js";const K=[{title:"Tableau de bord",href:"/dashboard"},{title:"Pièces jointes",href:"/pieces-jointes"}];function he({piecesJointes:o,filters:l,typesPieces:d}){const u=s=>{const a=s.target.value;c.get("/pieces-jointes",{search:a,type_piece:l.type_piece},{preserveState:!0,replace:!0})},f=s=>{c.get("/pieces-jointes",{search:l.search,type_piece:s},{preserveState:!0,replace:!0})},g=s=>{c.delete(`/pieces-jointes/${s.id}`,{preserveState:!0,replace:!0,onSuccess:()=>{m.success("Pièce jointe supprimée avec succès.")},onError:()=>{m.error("Une erreur est survenue lors de la suppression de la pièce jointe.")}})},b=s=>{if(!s.attachable)return"N/A";if(s.attachable_type==="App\\Models\\Citoyen"){const a=s.attachable;return`${a.nom} ${a.prenom}`}else if(s.attachable_type==="App\\Models\\Mariage"){const a=s.attachable;return`${a.homme?.nom} & ${a.femme?.nom}`}return"N/A"},y=s=>s.attachable?s.attachable_type==="App\\Models\\Citoyen"?`/citoyens/${s.attachable.ref}`:s.attachable_type==="App\\Models\\Mariage"?`/mariages/${s.attachable.id}`:"#":"#";return e.jsxs(A,{breadcrumbs:K,children:[e.jsx(v,{title:"Gestion des pièces jointes"}),e.jsxs("div",{className:"flex flex-col gap-4 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Gestion des pièces jointes"}),e.jsx(i,{href:"/pieces-jointes/create",children:e.jsxs(n,{children:[e.jsx(_,{className:"mr-2 h-4 w-4"}),"Ajouter une pièce jointe"]})})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(T,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(N,{placeholder:"Rechercher par numéro ou nom...",className:"pl-9",defaultValue:l.search,onChange:u})]}),e.jsx("div",{className:"w-48",children:e.jsxs(B,{value:l.type_piece||"",onValueChange:f,children:[e.jsx(R,{children:e.jsx(G,{placeholder:"Tous les types"})}),e.jsxs(O,{children:[e.jsx(j,{value:void 0,children:"Tous les types"}),Object.entries(d).map(([s,a])=>e.jsx(j,{value:s,children:a},s))]})]})})]}),e.jsx("div",{className:"rounded-md border",children:e.jsxs(D,{children:[e.jsx(S,{children:e.jsxs(h,{children:[e.jsx(r,{children:"Type"}),e.jsx(r,{children:"Numéro"}),e.jsx(r,{children:"Attaché à"}),e.jsx(r,{children:"Dates"}),e.jsx(r,{children:"Fichier"}),e.jsx(r,{className:"text-right",children:"Actions"})]})}),e.jsx(C,{children:o.data.map(s=>e.jsxs(h,{children:[e.jsx(t,{className:"font-medium",children:d[s.type_piece]||s.type_piece}),e.jsx(t,{children:s.numero_piece}),e.jsx(t,{children:e.jsx(i,{href:y(s),className:"text-primary hover:underline",children:b(s)})}),e.jsxs(t,{children:[p(new Date(s.date_emission),"dd/MM/yyyy",{locale:x}),s.date_expiration&&` → ${p(new Date(s.date_expiration),"dd/MM/yyyy",{locale:x})}`]}),e.jsx(t,{children:e.jsxs("a",{href:`/storage/${s.fichier}`,target:"_blank",className:"flex items-center text-primary hover:underline",children:[e.jsx(U,{className:"h-4 w-4 mr-1"}),"Voir le fichier"]})}),e.jsxs(t,{className:"flex justify-end gap-2",children:[e.jsx(i,{href:`/pieces-jointes/${s.id}`,children:e.jsx(n,{variant:"outline",size:"sm",children:e.jsx(w,{className:"h-4 w-4"})})}),e.jsx(i,{href:`/pieces-jointes/${s.id}/edit`,children:e.jsx(n,{variant:"outline",size:"sm",children:e.jsx(q,{className:"h-4 w-4"})})}),e.jsxs($,{children:[e.jsx(M,{asChild:!0,children:e.jsx(n,{variant:"destructive",size:"sm",children:e.jsx(P,{className:"h-4 w-4"})})}),e.jsxs(F,{children:[e.jsxs(H,{children:[e.jsx(k,{children:"Êtes-vous sûr de vouloir supprimer cette pièce jointe?"}),e.jsx(E,{children:"Cette action ne peut pas être annulée. Cela supprimera définitivement le fichier de nos serveurs."})]}),e.jsxs(I,{children:[e.jsx(L,{children:"Annuler"}),e.jsx(V,{onClick:()=>g(s),children:"Supprimer"})]})]})]})]})]},s.id))})]})}),e.jsx(z,{data:o})]})]})}export{he as default};
