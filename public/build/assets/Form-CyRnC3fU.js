import{j as e,u as E,H as P}from"./app-Bo2Vbsnc.js";import{a as V,B as f}from"./createLucideIcon-XQw2-DSi.js";import{L as l}from"./label-Dk2z4hvO.js";import{S as c,a as m,b as u,c as x,d}from"./select-VnT2g1FZ.js";import{t as p}from"./index-C2ywKrme.js";import{A as $}from"./app-layout-DdHLMRH3.js";import{M as v}from"./example-date-picker-D5MQFrMm.js";import{f as _,a as N}from"./fr-BP0VUzFK.js";/* empty css            */import"./index-BNGQMMhk.js";import"./index-vs_CEgml.js";import"./chevron-right-DL2bW7BS.js";import"./check-PfBPDYQe.js";import"./app-logo-icon-CS4oG-CN.js";import"./popover-YZJZ8lM_.js";import"./chevron-left-CeZ96CWT.js";function I({className:r,...o}){return e.jsx("textarea",{"data-slot":"textarea",className:V("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),...o})}function Y({etape:r,mariages:o,fonctionnaires:S,etapesOptions:j,statutsOptions:b,breadcrumbs:w,title:g}){const{data:a,setData:i,post:C,put:D,processing:y,errors:t,reset:F}=E({mariage_id:r?.mariage_id||"",etape:r?.etape||Object.keys(j)[0],statut:r?.statut||Object.keys(b)[0],date_debut:r?.date_debut||null,date_fin:r?.date_fin||null,responsable_id:r?.responsable_id||null,commentaires:r?.commentaires||null}),M=s=>{s.preventDefault(),r?D(`/etapes-mariage/${r.id}`,{onSuccess:()=>p.success("Étape mise à jour avec succès."),onError:()=>p.error("Une erreur est survenue lors de la mise à jour."),preserveScroll:!0}):C("/etapes-mariage",{onSuccess:()=>{p.success("Étape enregistrée avec succès."),F()},onError:()=>p.error("Une erreur est survenue lors de l'enregistrement.")})},k=s=>`${s.homme?.nom} ${s.homme?.prenom} & ${s.femme?.nom} ${s.femme?.prenom}`,n=o.find(s=>s.id===Number(a.mariage_id));return e.jsxs($,{breadcrumbs:w,children:[e.jsx(P,{title:g}),e.jsxs("div",{className:"p-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6",children:g}),e.jsxs("form",{onSubmit:M,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"mariage_id",children:"Mariage concerné *"}),e.jsxs(c,{value:a.mariage_id.toString(),onValueChange:s=>i("mariage_id",parseInt(s)),children:[e.jsx(m,{children:e.jsx(u,{placeholder:"Sélectionner un mariage"})}),e.jsx(x,{children:o.map(s=>e.jsxs(d,{value:s.id.toString(),children:[k(s)," - ",_(new Date(s.date_mariage),"PP",{locale:N})]},s.id))})]}),t.mariage_id&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:t.mariage_id}),n&&e.jsxs("div",{className:"mt-2 p-3 border rounded-lg bg-muted/50",children:[e.jsx("p",{className:"text-sm font-medium",children:"Informations du mariage:"}),e.jsxs("p",{className:"text-sm",children:[_(new Date(n.date_mariage),"PP",{locale:N})," à ",n.lieu_mariage]}),e.jsxs("p",{className:"text-sm",children:["Officier: ",n.officier?.nom," ",n.officier?.prenom]})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"etape",children:"Étape *"}),e.jsxs(c,{value:a.etape,onValueChange:s=>i("etape",s),children:[e.jsx(m,{children:e.jsx(u,{placeholder:"Sélectionner une étape"})}),e.jsx(x,{children:Object.entries(j).map(([s,h])=>e.jsx(d,{value:s,children:h},s))})]}),t.etape&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:t.etape})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"statut",children:"Statut *"}),e.jsxs(c,{value:a.statut,onValueChange:s=>i("statut",s),children:[e.jsx(m,{children:e.jsx(u,{placeholder:"Sélectionner un statut"})}),e.jsx(x,{children:Object.entries(b).map(([s,h])=>e.jsx(d,{value:s,children:h},s))})]}),t.statut&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:t.statut})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(v,{label:"Date de début",value:a.date_debut?new Date(a.date_debut):null,onChange:s=>i("date_debut",s)}),t.date_debut&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:t.date_debut})]}),e.jsxs("div",{children:[e.jsx(v,{label:"Date de fin",value:a.date_fin?new Date(a.date_fin):null,onChange:s=>i("date_fin",s),minDate:a.date_debut?new Date(a.date_debut):void 0}),t.date_fin&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:t.date_fin})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"responsable_id",children:"Responsable"}),e.jsxs(c,{value:a.responsable_id?.toString()||"",onValueChange:s=>i("responsable_id",s?parseInt(s):null),children:[e.jsx(m,{children:e.jsx(u,{placeholder:"Sélectionner un responsable"})}),e.jsxs(x,{children:[e.jsx(d,{value:null,children:"Non assigné"}),S.map(s=>e.jsxs(d,{value:s.id.toString(),children:[s.nom," ",s.prenom," (",s.fonction,")"]},s.id))]})]}),t.responsable_id&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:t.responsable_id})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"commentaires",children:"Commentaires"}),e.jsx(I,{id:"commentaires",value:a.commentaires||"",onChange:s=>i("commentaires",s.target.value),placeholder:"Notes supplémentaires sur cette étape...",className:"min-h-[100px]"}),t.commentaires&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:t.commentaires})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-4 pt-4",children:[e.jsx(f,{type:"button",variant:"outline",onClick:()=>window.history.back(),children:"Annuler"}),e.jsx(f,{type:"submit",disabled:y,children:r?"Mettre à jour":"Enregistrer"})]})]})]})]})}export{Y as default};
